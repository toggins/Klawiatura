project(discord)
add_library(discord SHARED IMPORTED GLOBAL)

# FIXME: Add support for ARM64 builds.
if (IS_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk")
    if (WIN32)
        if(${CMAKE_SIZEOF_VOID_P} STREQUAL 4)
            message(NOTICE "32-bit Windows detected, excluding Discord functionality")
        else()
            set_property(TARGET discord PROPERTY IMPORTED_LOCATION_RELEASE "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/bin/release/discord_partner_sdk.dll")
            set_property(TARGET discord PROPERTY IMPORTED_IMPLIB_RELEASE "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/lib/release/discord_partner_sdk.lib")
            set_property(TARGET discord PROPERTY IMPORTED_LOCATION_DEBUG "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/bin/debug/discord_partner_sdk.dll")
            set_property(TARGET discord PROPERTY IMPORTED_IMPLIB_DEBUG "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/lib/debug/discord_partner_sdk.lib")
            set_property(TARGET discord PROPERTY INTERFACE_INCLUDE_DIRECTORIES "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/include")
            set(KLAW_DISCORD TRUE PARENT_SCOPE)
        endif()
    elseif (LINUX)
        if(${CMAKE_SIZEOF_VOID_P} STREQUAL 4)
            message(NOTICE "32-bit Linux detected, excluding Discord functionality")
        else()
            set_property(TARGET discord PROPERTY IMPORTED_LOCATION_RELEASE "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/lib/release/libdiscord_partner_sdk.so")
            set_property(TARGET discord PROPERTY IMPORTED_LOCATION_DEBUG "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/lib/debug/libdiscord_partner_sdk.so")
            set_property(TARGET discord PROPERTY INTERFACE_INCLUDE_DIRECTORIES "${CMAKE_CURRENT_SOURCE_DIR}/discord_social_sdk/include")
            set(KLAW_DISCORD TRUE PARENT_SCOPE)
        endif()
    endif()
else()
    message(NOTICE "Discord Social SDK not found, excluding Discord functionality")
endif()
